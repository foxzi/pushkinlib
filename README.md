# Pushkinlib

Web-—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–Ω–∏–≥ –ø–æ INPX-–∏–Ω–¥–µ–∫—Å—É —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π OPDS.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìö **–ü–∞—Ä—Å–∏–Ω–≥ INPX** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–¥–µ–∫—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫
- üîç **–ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫** - –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∞–≤—Ç–æ—Ä—É, –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- üåê **Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π SPA –Ω–∞ Vue.js
- üì± **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- üìñ **OPDS –∫–∞—Ç–∞–ª–æ–≥** - —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —á–∏—Ç–∞–ª–∫–∞–º–∏
- üóÇÔ∏è **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø–æ –∂–∞–Ω—Ä–∞–º, —Å–µ—Ä–∏—è–º, –∞–≤—Ç–æ—Ä–∞–º, –≥–æ–¥–∞–º
- ‚ö° **–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞** - SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–±–æ—Ä–∫–∞

```bash
go build -o pushkinlib ./cmd/pushkinlib
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```bash
cp .env.example .env
```

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `.env`:
```env
PORT=9090
BOOKS_DIR=/path/to/books
INPX_PATH=/path/to/catalog.inpx
CATALOG_TITLE=–ú–æ—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
```

### 3. –ó–∞–ø—É—Å–∫

```bash
./pushkinlib
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- **Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: http://localhost:9090/
- **API**: http://localhost:9090/api/v1/books
- **OPDS –∫–∞—Ç–∞–ª–æ–≥**: http://localhost:9090/opds

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ –∏–∑ –∫–Ω–∏–≥

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø–∞–ø–∫–∞ —Å –∫–Ω–∏–≥–∞–º–∏, –Ω–æ –Ω–µ—Ç INPX —Ñ–∞–π–ª–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞:

### 1. –°–±–æ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

```bash
go build -o catalog-generator ./cmd/catalog-generator
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–Ω–∏–≥

–ü–æ–º–µ—Å—Ç–∏—Ç–µ –∫–Ω–∏–≥–∏ –≤ –ø–∞–ø–∫—É `./sample-data/books/`:
```
sample-data/books/
‚îú‚îÄ‚îÄ book1.fb2
‚îú‚îÄ‚îÄ book2.zip
‚îú‚îÄ‚îÄ book3.epub
‚îî‚îÄ‚îÄ subfolder/
    ‚îî‚îÄ‚îÄ book4.fb2
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞

```bash
./catalog-generator -books=./sample-data/books -name=my_catalog
```

–û–ø—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞:
- `-books` - –ø–∞–ø–∫–∞ —Å –∫–Ω–∏–≥–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `./sample-data/books`)
- `-output` - –ø–∞–ø–∫–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `./sample-data`)
- `-name` - –∏–º—è –∫–∞—Ç–∞–ª–æ–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `generated_catalog`)
- `-prefix` - –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª—è –∞—Ä—Ö–∏–≤–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `books`)
- `-max-books` - –º–∞–∫—Å–∏–º—É–º –∫–Ω–∏–≥ –≤ –∞—Ä—Ö–∏–≤–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1000)
- `-formats` - —Ñ–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `.fb2,.zip,.epub`)

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–∏—Ç–µ `.env`:
```env
INPX_PATH=./sample-data/my_catalog.inpx
BOOKS_DIR=./sample-data
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **FB2** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **FB2.ZIP** - FB2 —Ñ–∞–π–ª—ã –≤ ZIP –∞—Ä—Ö–∏–≤–∞—Ö
- **EPUB** - –±–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∞–≤—Ç–æ—Ä)

### –§–∞–π–ª—ã –∫–∞—Ç–∞–ª–æ–≥–∞
- **INPX** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–Ω–¥–µ–∫—Å–æ–≤
- **INP** - –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–Ω–¥–µ–∫—Å–æ–≤

## API

### –ü–æ–∏—Å–∫ –∫–Ω–∏–≥
```http
GET /api/v1/books?q=–∑–∞–ø—Ä–æ—Å&limit=30&offset=0
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `q` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 30)
- `offset` - —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `authors[]` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∞–≤—Ç–æ—Ä–∞–º
- `series[]` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å–µ—Ä–∏—è–º
- `genres[]` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∂–∞–Ω—Ä–∞–º
- `year_from`, `year_to` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –≥–æ–¥–∞–º
- `sort_by` - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (`title`, `year`, `date_added`, `relevance`)
- `sort_order` - –ø–æ—Ä—è–¥–æ–∫ (`asc`, `desc`)

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥–∏
```http
GET /api/v1/books/{id}
```

## OPDS

OPDS –∫–∞—Ç–∞–ª–æ–≥ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `/opds` –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

- **–ù–∞–≤–∏–≥–∞—Ü–∏—é** - –ø–æ –∞–≤—Ç–æ—Ä–∞–º, —Å–µ—Ä–∏—è–º, –∂–∞–Ω—Ä–∞–º
- **–ü–æ–∏—Å–∫** - —Å–æ–≤–º–µ—Å—Ç–∏–º —Å OpenSearch
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—é** - –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ** - –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∏—Ç–∞–ª–æ–∫

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à—É —á–∏—Ç–∞–ª–∫—É OPDS –∫–∞—Ç–∞–ª–æ–≥:
```
http://your-server:9090/opds
```

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∏—Ç–∞–ª–∫–∏:
- FBReader
- KyBook
- Bookari
- Moon+ Reader

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
pushkinlib/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îú‚îÄ‚îÄ pushkinlib/          # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ catalog-generator/   # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–∞—Ç–∞–ª–æ–≥–æ–≤
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ api/                 # HTTP API handlers
‚îÇ   ‚îú‚îÄ‚îÄ auth/                # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ catalog/             # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ config/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ covers/              # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–ª–æ–∂–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ inpx/                # –ü–∞—Ä—Å–∏–Ω–≥ INPX
‚îÇ   ‚îú‚îÄ‚îÄ metadata/            # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ opds/                # OPDS –∫–∞—Ç–∞–ª–æ–≥
‚îÇ   ‚îú‚îÄ‚îÄ search/              # –ü–æ–∏—Å–∫ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ storage/             # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ web/static/              # Frontend (Vue.js SPA)
‚îî‚îÄ‚îÄ sample-data/             # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
go test ./...

# –¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞ INPX
go test ./internal/inpx -v

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞
./catalog-generator -books=./sample-data/books
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub.